<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yunqi Yang" />


<title>t2d data application</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">udr-data-application</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">t2d data application</h1>
<h4 class="author">Yunqi Yang</h4>
<h4 class="date">9/20/2022</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-09-22
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>udr-data-application/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20191120code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20191120)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20191120code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20191120)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomstephenslabudrdataapplicationtree3742095f9a325e7a910ee01f9cb9ffb7752cd1f5targetblank3742095a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/stephenslab/udr-data-application/tree/3742095f9a325e7a910ee01f9cb9ffb7752cd1f5" target="_blank">3742095</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomstephenslabudrdataapplicationtree3742095f9a325e7a910ee01f9cb9ffb7752cd1f5targetblank3742095a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/stephenslab/udr-data-application/tree/3742095f9a325e7a910ee01f9cb9ffb7752cd1f5" target="_blank">3742095</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  t2d_patterns.pdf
    Untracked:  t2d_patterns_flashier.pdf

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/t2d_application.Rmd</code>) and HTML (<code>docs/t2d_application.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/stephenslab/udr-data-application/blob/3742095f9a325e7a910ee01f9cb9ffb7752cd1f5/analysis/t2d_application.Rmd" target="_blank">3742095</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2022-09-22
</td>
<td>
wflow_publish("analysis/t2d_application.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/stephenslab/udr-data-application/8ededab43f96754efee6b44d7c7a9316d8720143/docs/t2d_application.html" target="_blank">8ededab</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2022-09-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/stephenslab/udr-data-application/blob/0f2412222b71c89ce4d57994d033e1bbc2134421/analysis/t2d_application.Rmd" target="_blank">0f24122</a>
</td>
<td>
yunqiyang0215
</td>
<td>
2022-09-20
</td>
<td>
wflow_publish("analysis/t2d_application.rmd")
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="description-apply-udr-to-type-2-diabetes-dataset-from-dr.udler." class="section level3">
<h3>Description: Apply udr to type 2 diabetes dataset from Dr.Udler.</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Data Description</strong>: In total, it contains 324 SNPs with 65 conditions. All SNPs are strong signals in at least one condition, meaning abs(z-score) &gt;= 1.96. After remove SNPs with missing z-score, there are 305 SNPs.</p></li>
<li><p><strong>Initialization</strong>: I randomly initialized 20 unconstrained <span class="math inline">\(U\)</span>s and 4 rank1 <span class="math inline">\(U\)</span>s for fitting. I use nuclear norm regularization with <span class="math inline">\(\lambda\)</span> (regularization strength) equals the number of conditions. <span class="math inline">\(V\)</span> is set to be identity matrix.</p></li>
</ol>
<pre class="r"><code>library(&quot;readxl&quot;)
library(udr)
library(gridExtra)
#devtools::install_github(&quot;eweine/MASHvFLASH&quot;, subdir = &quot;mishmashr&quot;)
library(mishmashr)
dat = read_excel(&quot;./data/t2d.xlsx&quot;)</code></pre>
<pre class="r"><code>dat = data.frame(dat)
rownames(dat) = dat[,1]
dat = dat[,-1]</code></pre>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory data analysis</h2>
<pre class="r"><code>summary(dat)</code></pre>
<pre><code> MAGIC_dv1_2hrG    ADIPOGen_dv1_Adiponectin BFpercent_dv1_BFP  
 Min.   :-4.7016   Min.   :-9.0448          Min.   :-6.708333  
 1st Qu.:-0.1263   1st Qu.:-1.4799          1st Qu.:-1.081263  
 Median : 0.6257   Median :-0.4483          Median :-0.098020  
 Mean   : 0.6327   Mean   :-0.6359          Mean   :-0.009601  
 3rd Qu.: 1.3767   3rd Qu.: 0.4888          3rd Qu.: 0.981013  
 Max.   : 4.6160   Max.   : 3.8193          Max.   : 9.941176  
 NA&#39;s   :3                                                     
 GiantUKBB_eu_dv1_BMI  MAGIC_dv1_FG     MAGIC_dv2_FI     MAGIC_eu_dv6_HBA1C
 Min.   :-8.4444      Min.   :-3.636   Min.   :-4.6341   Min.   :-1.737    
 1st Qu.:-2.0192      1st Qu.: 0.297   1st Qu.:-0.7466   1st Qu.: 0.460    
 Median : 0.1177      Median : 1.050   Median : 0.2190   Median : 1.307    
 Mean   : 1.3130      Mean   : 1.210   Mean   : 0.3513   Mean   : 1.528    
 3rd Qu.: 3.1202      3rd Qu.: 1.805   3rd Qu.: 1.3587   3rd Qu.: 2.250    
 Max.   :45.7647      Max.   :13.953   Max.   : 6.0000   Max.   :11.200    
 NA&#39;s   :5                                                                 
 GiantUKBB_eu_dv1_HEIGHT GIANT_eu_females_dv5_HIPCadjBMI
 Min.   :-40.7143        Min.   :-12.4000               
 1st Qu.: -2.9706        1st Qu.: -1.4341               
 Median : -0.5333        Median : -0.3509               
 Mean   : -0.8867        Mean   : -0.5513               
 3rd Qu.:  1.8333        3rd Qu.:  0.5429               
 Max.   : 24.9286        Max.   :  4.6296               
 NA&#39;s   :5               NA&#39;s   :1                      
 GIANT_eu_males_dv5_HIPCadjBMI MAGIC_dv1_HOMAB   MAGIC_dv1_HOMAIR 
 Min.   :-6.7308               Min.   :-7.8378   Min.   :-2.7660  
 1st Qu.:-1.2222               1st Qu.:-1.2320   1st Qu.:-0.5503  
 Median :-0.2778               Median :-0.3148   Median : 0.3604  
 Mean   :-0.4019               Mean   :-0.2984   Mean   : 0.4397  
 3rd Qu.: 0.6455               3rd Qu.: 0.8188   3rd Qu.: 1.3436  
 Max.   : 4.2708               Max.   : 3.1429   Max.   : 4.7500  
 NA&#39;s   :11                                                       
 MAGIC_dv4_ISIadjAgeSexBMI Leptin_eu_dv1_LEP Leptin_eu_dv1_LEPadjBMI
 Min.   :-6.4000           Min.   :-3.8600   Min.   :-4.2462        
 1st Qu.:-1.2121           1st Qu.:-0.5913   1st Qu.:-0.5949        
 Median :-0.2864           Median : 0.2083   Median : 0.2239        
 Mean   :-0.4544           Mean   : 0.1611   Mean   : 0.2489        
 3rd Qu.: 0.4023           3rd Qu.: 0.9278   3rd Qu.: 1.0478        
 Max.   : 2.9545           Max.   : 4.9796   Max.   : 5.2381        
 NA&#39;s   :2                 NA&#39;s   :1         NA&#39;s   :1              
  MAGIC_dv1_PI      GIANT_eu_females_dv5_WAIST GIANT_eu_males_dv5_WAIST
 Min.   :-13.0000   Min.   :-4.6000            Min.   :-7.08333        
 1st Qu.: -0.4571   1st Qu.:-0.6598            1st Qu.:-1.09240        
 Median :  0.3392   Median : 0.3239            Median :-0.07896        
 Mean   :  0.2867   Mean   : 0.5726            Mean   : 0.06923        
 3rd Qu.:  1.0064   3rd Qu.: 1.4706            3rd Qu.: 0.90079        
 Max.   :  8.4444   Max.   :15.7778            Max.   :16.38298        
                    NA&#39;s   :1                  NA&#39;s   :6               
 GIANT_eu_females_dv5_WAISTadjBMI GIANT_eu_males_dv5_WAISTadjBMI
 Min.   :-4.3182                  Min.   :-5.3846               
 1st Qu.:-0.3024                  1st Qu.:-1.0300               
 Median : 0.4615                  Median :-0.1132               
 Mean   : 0.6837                  Mean   :-0.1462               
 3rd Qu.: 1.4071                  3rd Qu.: 0.7696               
 Max.   :11.4286                  Max.   : 4.2466               
 NA&#39;s   :1                        NA&#39;s   :8                     
 GIANT_eu_females_dv5_WHR GIANT_eu_males_dv5_WHR GIANT_eu_females_dv5_WHRadjBMI
 Min.   :-5.40000         Min.   :-5.7143        Min.   :-4.1176               
 1st Qu.:-0.05289         1st Qu.:-0.5998        1st Qu.:-0.1176               
 Median : 0.72727         Median : 0.3158        Median : 0.6792               
 Mean   : 1.04842         Mean   : 0.3332        Mean   : 1.0237               
 3rd Qu.: 1.83667         3rd Qu.: 1.1396        3rd Qu.: 1.7165               
 Max.   :10.00000         Max.   :10.4167        Max.   :12.2000               
 NA&#39;s   :1                NA&#39;s   :9              NA&#39;s   :1                     
 GIANT_eu_males_dv5_WHRadjBMI MAGIC_dv5_CIR      MAGIC_dv5_DI    
 Min.   :-5.7143              Min.   :-6.8182   Min.   :-7.2727  
 1st Qu.:-0.6545              1st Qu.:-1.1805   1st Qu.:-1.1468  
 Median : 0.2600              Median :-0.3181   Median :-0.4317  
 Mean   : 0.2605              Mean   :-0.4284   Mean   :-0.4514  
 3rd Qu.: 1.0727              3rd Qu.: 0.4436   3rd Qu.: 0.3856  
 Max.   : 4.4000              Max.   : 2.6500   Max.   : 3.0938  
 NA&#39;s   :11                   NA&#39;s   :2         NA&#39;s   :2        
 UKBB_White.blood.cell..leukocyte..count_irnt_both
 Min.   :-18.2208                                 
 1st Qu.: -0.7697                                 
 Median :  0.6758                                 
 Mean   :  0.6271                                 
 3rd Qu.:  2.4026                                 
 Max.   : 15.3512                                 
                                                  
 UKBB_Red.blood.cell..erythrocyte..count_irnt_both
 Min.   :-14.7225                                 
 1st Qu.: -0.9043                                 
 Median :  0.5586                                 
 Mean   :  0.5325                                 
 3rd Qu.:  2.0537                                 
 Max.   : 14.1924                                 
                                                  
 UKBB_Haemoglobin.concentration_irnt_both
 Min.   :-16.5546                        
 1st Qu.: -1.1570                        
 Median :  0.2704                        
 Mean   :  0.2186                        
 3rd Qu.:  1.5898                        
 Max.   : 10.6601                        
                                         
 UKBB_Mean.corpuscular.volume_irnt_both
 Min.   :-21.6424                      
 1st Qu.: -2.0429                      
 Median : -0.5790                      
 Mean   : -0.6121                      
 3rd Qu.:  0.7729                      
 Max.   : 34.0513                      
                                       
 UKBB_Red.blood.cell..erythrocyte..distribution.width_irnt_both
 Min.   :-13.6756                                              
 1st Qu.: -1.6386                                              
 Median : -0.1589                                              
 Mean   :  0.1490                                              
 3rd Qu.:  1.2334                                              
 Max.   : 30.7538                                              
                                                               
 UKBB_Platelet.count_irnt_both
 Min.   :-16.9557             
 1st Qu.: -1.6401             
 Median : -0.3097             
 Mean   : -0.3738             
 3rd Qu.:  1.1401             
 Max.   : 12.3754             
                              
 UKBB_Mean.platelet..thrombocyte..volume_irnt_both
 Min.   :-12.5186                                 
 1st Qu.: -1.2068                                 
 Median :  0.1079                                 
 Mean   :  0.2361                                 
 3rd Qu.:  1.2998                                 
 Max.   : 22.8954                                 
                                                  
 UKBB_Platelet.distribution.width_irnt_both UKBB_Lymphocyte.count_irnt_both
 Min.   :-9.9613                            Min.   :-16.6525               
 1st Qu.:-0.6762                            1st Qu.: -0.7528               
 Median : 0.6511                            Median :  0.5302               
 Mean   : 0.7695                            Mean   :  0.6259               
 3rd Qu.: 1.8587                            3rd Qu.:  2.0755               
 Max.   :13.7195                            Max.   : 18.2743               
                                                                           
 UKBB_Monocyte.count_irnt_both UKBB_Eosinophill.count_irnt_both
 Min.   :-17.4017              Min.   :-9.2045                 
 1st Qu.: -0.9571              1st Qu.:-0.8276                 
 Median :  0.3107              Median : 0.3684                 
 Mean   :  0.1146              Mean   : 0.3035                 
 3rd Qu.:  1.5570              3rd Qu.: 1.4853                 
 Max.   :  6.8904              Max.   :11.6449                 
                                                               
 UKBB_Basophill.count_irnt_both UKBB_Mean.reticulocyte.volume_irnt_both
 Min.   :-4.78292               Min.   :-12.3778                       
 1st Qu.:-0.75775               1st Qu.: -1.7593                       
 Median : 0.05358               Median : -0.4256                       
 Mean   :-0.01316               Mean   : -0.2459                       
 3rd Qu.: 0.79590               3rd Qu.:  0.8440                       
 Max.   : 4.60448               Max.   : 35.6927                       
                                                                       
 UKBB_High.light.scatter.reticulocyte.count_irnt_both
 Min.   :-10.3262                                    
 1st Qu.: -0.1231                                    
 Median :  1.4324                                    
 Mean   :  1.5276                                    
 3rd Qu.:  3.0871                                    
 Max.   : 33.5552                                    
                                                     
 UKBB_Albumin..quantile._irnt_both
 Min.   :-22.2720                 
 1st Qu.: -1.1065                 
 Median :  0.5980                 
 Mean   :  0.5194                 
 3rd Qu.:  1.9410                 
 Max.   : 13.0821                 
                                  
 UKBB_Alkaline.phosphatase..quantile._irnt_both
 Min.   :-102.42449                            
 1st Qu.:  -1.08833                            
 Median :   0.28181                            
 Mean   :   0.02559                            
 3rd Qu.:   1.79791                            
 Max.   :  32.60653                            
                                               
 UKBB_Alanine.aminotransferase..quantile._irnt_both
 Min.   :-5.60888                                  
 1st Qu.:-0.02731                                  
 Median : 1.50262                                  
 Mean   : 1.91352                                  
 3rd Qu.: 3.31938                                  
 Max.   :36.65126                                  
                                                   
 UKBB_Apoliprotein.B..quantile._irnt_both
 Min.   :-62.2517                        
 1st Qu.: -1.2973                        
 Median : -0.2485                        
 Mean   : -0.3145                        
 3rd Qu.:  1.0240                        
 Max.   :  9.5859                        
                                         
 UKBB_Aspartate.aminotransferase..quantile._irnt_both
 Min.   :-14.4419                                    
 1st Qu.: -1.2424                                    
 Median :  0.3908                                    
 Mean   :  0.5634                                    
 3rd Qu.:  1.9606                                    
 Max.   : 36.1778                                    
                                                     
 UKBB_Direct.bilirubin..quantile._irnt_both UKBB_Urea..quantile._irnt_both
 Min.   :-6.76699                           Min.   :-11.9129              
 1st Qu.:-0.87599                           1st Qu.: -0.7853              
 Median :-0.03287                           Median :  0.4104              
 Mean   :-0.01376                           Mean   :  0.3251              
 3rd Qu.: 0.85249                           3rd Qu.:  1.5182              
 Max.   :12.96292                           Max.   :  7.2983              
                                                                          
 UKBB_Calcium..quantile._irnt_both UKBB_C.reactive.protein..quantile._irnt_both
 Min.   :-18.3632                  Min.   :-35.9112                            
 1st Qu.: -0.7259                  1st Qu.: -1.2164                            
 Median :  0.5552                  Median :  0.3625                            
 Mean   :  0.5275                  Mean   :  0.4326                            
 3rd Qu.:  1.8539                  3rd Qu.:  2.1565                            
 Max.   :  9.3335                  Max.   : 62.7113                            
                                                                               
 UKBB_Gamma.glutamyltransferase..quantile._irnt_both
 Min.   :-32.1167                                   
 1st Qu.: -0.2238                                   
 Median :  1.3074                                   
 Mean   :  1.2105                                   
 3rd Qu.:  2.8998                                   
 Max.   : 11.3009                                   
                                                    
 UKBB_Glucose..quantile._irnt_both UKBB_HDL.cholesterol..quantile._irnt_both
 Min.   :-8.193                    Min.   :-45.11552                        
 1st Qu.: 0.992                    1st Qu.: -3.47943                        
 Median : 2.388                    Median : -1.53624                        
 Mean   : 2.997                    Mean   : -2.31456                        
 3rd Qu.: 4.031                    3rd Qu.:  0.01377                        
 Max.   :31.513                    Max.   : 18.22511                        
                                                                            
 UKBB_IGF.1..quantile._irnt_both UKBB_Lipoprotein.A..quantile._irnt_both
 Min.   :-8.5869                 Min.   :-3.33277                       
 1st Qu.:-1.3329                 1st Qu.:-0.91386                       
 Median : 0.5221                 Median :-0.19555                       
 Mean   : 0.5547                 Mean   : 0.09755                       
 3rd Qu.: 2.0404                 3rd Qu.: 0.61855                       
 Max.   :24.6888                 Max.   :85.39116                       
                                                                        
 UKBB_Phosphate..quantile._irnt_both UKBB_SHBG..quantile._irnt_both
 Min.   :-8.51235                    Min.   :-90.5859              
 1st Qu.:-1.13720                    1st Qu.: -4.4009              
 Median :-0.00023                    Median : -2.2519              
 Mean   : 0.17706                    Mean   : -2.7702              
 3rd Qu.: 1.20004                    3rd Qu.: -0.8199              
 Max.   :32.00750                    Max.   : 28.2952              
                                                                   
 UKBB_Total.bilirubin..quantile._irnt_both
 Min.   :-8.5200                          
 1st Qu.:-1.2574                          
 Median :-0.2294                          
 Mean   :-0.3209                          
 3rd Qu.: 0.7218                          
 Max.   : 9.4678                          
                                          
 UKBB_Testosterone..quantile._irnt_female
 Min.   :-6.2869                         
 1st Qu.:-1.0626                         
 Median : 0.0296                         
 Mean   :-0.0496                         
 3rd Qu.: 0.9504                         
 Max.   : 8.3395                         
                                         
 UKBB_Total.protein..quantile._irnt_both
 Min.   :-16.4540                       
 1st Qu.: -0.9606                       
 Median :  0.4092                       
 Mean   :  0.3411                       
 3rd Qu.:  1.6455                       
 Max.   : 10.1773                       
                                        
 UKBB_Triglycerides..quantile._irnt_both UKBB_Urate..quantile._irnt_both
 Min.   :-42.23156                       Min.   :-22.2579               
 1st Qu.:  0.08495                       1st Qu.: -0.6106               
 Median :  1.56697                       Median :  0.9630               
 Mean   :  2.04582                       Mean   :  1.0268               
 3rd Qu.:  3.99707                       3rd Qu.:  2.6742               
 Max.   : 50.45309                       Max.   : 12.5405               
                                                                        
 UKBB_Vitamin.D..quantile._irnt_both
 Min.   :-6.2730                    
 1st Qu.:-1.5909                    
 Median :-0.5612                    
 Mean   :-0.5202                    
 3rd Qu.: 0.4173                    
 Max.   : 8.1506                    
                                    
 UKBB_Diastolic.blood.pressure..automated.reading_irnt_both
 Min.   :-6.1009                                           
 1st Qu.:-0.8588                                           
 Median : 0.3509                                           
 Mean   : 0.4356                                           
 3rd Qu.: 1.8728                                           
 Max.   : 5.6658                                           
                                                           
 UKBB_Systolic.blood.pressure..automated.reading_irnt_both
 Min.   :-5.2925                                          
 1st Qu.:-0.2404                                          
 Median : 0.9313                                          
 Mean   : 0.9694                                          
 3rd Qu.: 2.0875                                          
 Max.   : 7.4847                                          
                                                          </code></pre>
<pre class="r"><code># Select strong signals
signals = apply(dat, 1, function(x) sum(abs(x) &gt;= 1.96, na.rm = TRUE) != 0)
# Remove NAs
nas = apply(dat, 1, function(x) sum(is.na(x)) == 0)
dat2 = dat[nas, ]</code></pre>
</div>
<div id="run-udr" class="section level2">
<h2>Run udr</h2>
<pre class="r"><code>R = ncol(dat2)
K = 20
V = diag(R) # Use identity matrix for now
  
set.seed(999)
U.init = c()
for (k in 1:K){
  U.init[[k]] &lt;- udr:::sim_unconstrained(R)
}
X = as.matrix(dat2)
f0 = ud_init(X = X, V = V, U_scaled = NULL, U_unconstrained = U.init)</code></pre>
<pre class="r"><code>set.seed(1)
fit1 = ud_fit(f0, control = list(unconstrained.update = &quot;ted&quot;, rank1.update = &quot;ted&quot;, resid.update = &#39;none&#39;, scaled.update = &quot;fa&quot;, maxiter=1e3, tol = 1e-02, tol.lik = 1e-2, n0 = 0,
                                   lambda = R), verbose=TRUE)</code></pre>
<pre><code>control$scaled.update is ignored when no scaled covariances are included in U</code></pre>
<pre><code>Performing Ultimate Deconvolution on 305 x 64 matrix (udr 0.3-140, &quot;R&quot;):
data points are i.i.d. (same V)
prior covariances: 0 scaled, 4 rank-1, 20 unconstrained
prior covariance updates: scaled (none), rank-1 (ted), unconstrained (ted)
mixture weights update: em
residual covariance update: none
max 1000 updates, tol=1.0e-02, tol.lik=1.0e-02
iter          log-likelihood |w - w&#39;| |U - U&#39;| |V - V&#39;|
   1 -4.1778734067387224e+04 1.02e-01 1.05e+02 0.00e+00
   2 -4.0097929195367360e+04 1.00e-01 2.38e+01 0.00e+00
   3 -3.9650548119978972e+04 9.23e-03 7.31e+00 0.00e+00
   4 -3.9436399991444137e+04 5.87e-03 2.35e+00 0.00e+00
   5 -3.9319671088311617e+04 5.15e-03 1.32e+00 0.00e+00
   6 -3.9225966249799269e+04 4.95e-03 1.71e+00 0.00e+00
   7 -3.9168599634440987e+04 6.21e-03 4.65e+00 0.00e+00
   8 -3.9141252687644723e+04 6.19e-03 2.95e+00 0.00e+00
   9 -3.9110363554430682e+04 5.91e-03 2.15e+00 0.00e+00
  10 -3.9099434787462196e+04 5.01e-03 1.41e+00 0.00e+00
  11 -3.9073233712234512e+04 6.10e-03 1.23e+00 0.00e+00
  12 -3.9021295382383149e+04 8.59e-03 1.69e+00 0.00e+00
  13 -3.8997402612334037e+04 1.06e-02 2.89e+00 0.00e+00
  14 -3.8968839870865981e+04 1.02e-02 2.15e+00 0.00e+00
  15 -3.8928392166238060e+04 1.26e-02 1.07e+00 0.00e+00
  16 -3.8894097402311178e+04 1.07e-02 1.07e+00 0.00e+00
  17 -3.8840403658758070e+04 1.05e-02 1.03e+00 0.00e+00
  18 -3.8802554338952163e+04 1.08e-02 1.01e+00 0.00e+00
  19 -3.8733749360556962e+04 1.30e-02 1.22e+00 0.00e+00
  20 -3.8663415318312036e+04 2.32e-02 1.03e+00 0.00e+00
  21 -3.8623502786072750e+04 1.60e-02 9.55e-01 0.00e+00
  22 -3.8590804570378175e+04 1.01e-02 9.42e-01 0.00e+00
  23 -3.8557701327752344e+04 1.11e-02 9.71e-01 0.00e+00
  24 -3.8536473589981557e+04 8.41e-03 9.18e-01 0.00e+00
  25 -3.8503138309166519e+04 1.03e-02 9.26e-01 0.00e+00
  26 -3.8453594678200003e+04 1.57e-02 1.39e+00 0.00e+00
  27 -3.8410236331832406e+04 1.22e-02 1.57e+00 0.00e+00
  28 -3.8375246079166420e+04 1.05e-02 9.99e-01 0.00e+00
  29 -3.8349628900093827e+04 8.58e-03 9.85e-01 0.00e+00
  30 -3.8317443475869019e+04 8.72e-03 9.80e-01 0.00e+00
  31 -3.8301454543905966e+04 6.42e-03 9.74e-01 0.00e+00
  32 -3.8287893103411290e+04 4.79e-03 9.69e-01 0.00e+00
  33 -3.8251799318154888e+04 9.47e-03 9.64e-01 0.00e+00
  34 -3.8224335041230632e+04 6.68e-03 1.42e+00 0.00e+00
  35 -3.8209130520324448e+04 3.18e-03 9.53e-01 0.00e+00
  36 -3.8164098426803852e+04 2.88e-03 9.47e-01 0.00e+00
  37 -3.8144488444736264e+04 4.72e-03 9.42e-01 0.00e+00
  38 -3.8144344114151128e+04 1.03e-03 9.36e-01 0.00e+00
  39 -3.8145369174200059e+04 7.06e-04 9.31e-01 0.00e+00
  40 -3.8140930576961939e+04 1.49e-03 9.25e-01 0.00e+00
  41 -3.8138894293064805e+04 1.35e-03 9.20e-01 0.00e+00
  42 -3.8140728444568107e+04 1.02e-03 9.14e-01 0.00e+00
  43 -3.8136507001351958e+04 8.94e-04 9.09e-01 0.00e+00
  44 -3.8125582730284084e+04 2.31e-03 1.77e+00 0.00e+00
  45 -3.8121084511540648e+04 2.21e-03 8.98e-01 0.00e+00
  46 -3.8120777636047387e+04 1.72e-03 8.92e-01 0.00e+00
  47 -3.8117420453410603e+04 3.15e-03 8.87e-01 0.00e+00
  48 -3.8109349682450586e+04 4.27e-03 1.31e+00 0.00e+00
  49 -3.8095985214654458e+04 7.37e-03 8.76e-01 0.00e+00
  50 -3.8079638680715339e+04 1.05e-02 8.71e-01 0.00e+00
  51 -3.8075204713866646e+04 6.52e-03 8.65e-01 0.00e+00
  52 -3.8073698601328164e+04 4.02e-03 8.60e-01 0.00e+00
  53 -3.8074143456152888e+04 3.05e-03 8.55e-01 0.00e+00
  54 -3.8074917378445192e+04 1.64e-03 8.49e-01 0.00e+00
  55 -3.8075462784545038e+04 2.08e-03 8.44e-01 0.00e+00
  56 -3.8073568288534923e+04 2.71e-03 8.38e-01 0.00e+00
  57 -3.8071949173233188e+04 3.20e-03 8.33e-01 0.00e+00
  58 -3.8072568325897388e+04 9.67e-04 8.28e-01 0.00e+00
  59 -3.8033533007565653e+04 5.67e-03 1.59e+00 0.00e+00
  60 -3.8015690616892483e+04 4.46e-03 8.18e-01 0.00e+00
  61 -3.8016543161115806e+04 2.19e-03 8.12e-01 0.00e+00
  62 -3.8012646180917996e+04 1.01e-03 1.47e+00 0.00e+00
  63 -3.7994621379450335e+04 2.86e-03 8.77e+00 0.00e+00
  64 -3.7998135233741217e+04 7.29e-04 7.96e-01 0.00e+00
  65 -3.7998078888669246e+04 1.50e-03 7.91e-01 0.00e+00
  66 -3.7973003502925647e+04 4.50e-03 7.86e-01 0.00e+00
  67 -3.7961545452007806e+04 2.88e-03 7.81e-01 0.00e+00
  68 -3.7944200324782279e+04 3.14e-03 1.01e+00 0.00e+00
  69 -3.7945601602748487e+04 1.28e-03 7.70e-01 0.00e+00
  70 -3.7940623157844624e+04 1.38e-03 1.33e+00 0.00e+00
  71 -3.7907867019582838e+04 2.68e-03 1.45e+01 0.00e+00
  72 -3.7905618468750050e+04 3.19e-03 7.55e-01 0.00e+00
  73 -3.7904399453861079e+04 2.58e-03 7.50e-01 0.00e+00
  74 -3.7905924964348640e+04 5.97e-04 7.45e-01 0.00e+00
  75 -3.7899278733811509e+04 1.77e-03 1.88e+00 0.00e+00
  76 -3.7898492426417106e+04 1.22e-03 1.11e+00 0.00e+00
  77 -3.7900388437002301e+04 6.39e-05 7.30e-01 0.00e+00
  78 -3.7902177901215910e+04 4.70e-05 7.25e-01 0.00e+00
  79 -3.7903889710998046e+04 3.97e-05 7.20e-01 0.00e+00
  80 -3.7905546315877182e+04 3.67e-05 7.15e-01 0.00e+00
  81 -3.7907162331794716e+04 3.61e-05 7.10e-01 0.00e+00
  82 -3.7908748049638845e+04 3.71e-05 7.05e-01 0.00e+00
  83 -3.7910311971126372e+04 3.97e-05 7.01e-01 0.00e+00
  84 -3.7911863790889511e+04 4.42e-05 6.96e-01 0.00e+00
  85 -3.7913409971379340e+04 5.13e-05 6.91e-01 0.00e+00
  86 -3.7914998570497613e+04 6.28e-05 6.86e-01 0.00e+00
  87 -3.7916681703436931e+04 1.21e-04 6.81e-01 0.00e+00
  88 -3.7917844950361636e+04 4.19e-04 6.77e-01 0.00e+00
  89 -3.7914001360231858e+04 2.10e-03 6.72e-01 0.00e+00
  90 -3.7914723848528280e+04 3.96e-04 6.67e-01 0.00e+00
  91 -3.7915322689265449e+04 9.09e-04 6.62e-01 0.00e+00
  92 -3.7915160342363131e+04 1.51e-03 6.58e-01 0.00e+00
  93 -3.7916019271669793e+04 7.98e-04 6.53e-01 0.00e+00
  94 -3.7913626112449361e+04 1.34e-03 6.49e-01 0.00e+00
  95 -3.7904720407033557e+04 3.13e-03 6.71e-01 0.00e+00
  96 -3.7898509246476067e+04 2.95e-03 6.94e-01 0.00e+00
  97 -3.7900206510970682e+04 9.10e-04 6.35e-01 0.00e+00
  98 -3.7901592994450817e+04 7.02e-04 6.30e-01 0.00e+00
  99 -3.7898119954362810e+04 1.17e-03 6.26e-01 0.00e+00
 100 -3.7891927250171742e+04 1.94e-03 6.21e-01 0.00e+00
 101 -3.7893697294936814e+04 2.20e-04 6.17e-01 0.00e+00
 102 -3.7895442036892273e+04 7.99e-05 6.12e-01 0.00e+00
 103 -3.7897022512740659e+04 6.33e-05 6.08e-01 0.00e+00
 104 -3.7898490486636270e+04 5.37e-05 6.03e-01 0.00e+00
 105 -3.7899879758258277e+04 4.70e-05 5.99e-01 0.00e+00
 106 -3.7901211947197931e+04 4.19e-05 5.95e-01 0.00e+00
 107 -3.7902499853484369e+04 3.80e-05 5.90e-01 0.00e+00
 108 -3.7903753254512412e+04 3.49e-05 5.86e-01 0.00e+00
 109 -3.7904977034314186e+04 3.23e-05 5.82e-01 0.00e+00
 110 -3.7906175538135059e+04 3.02e-05 5.78e-01 0.00e+00
 111 -3.7907351788855864e+04 2.85e-05 5.73e-01 0.00e+00
 112 -3.7908508591187216e+04 2.71e-05 5.69e-01 0.00e+00
 113 -3.7909648830143095e+04 2.62e-05 5.65e-01 0.00e+00
 114 -3.7910776057942523e+04 3.41e-05 5.61e-01 0.00e+00
 115 -3.7911895672893384e+04 4.75e-05 5.57e-01 0.00e+00
 116 -3.7913016286661616e+04 7.30e-05 5.52e-01 0.00e+00
 117 -3.7914148007302923e+04 1.31e-04 5.48e-01 0.00e+00
 118 -3.7915216191648018e+04 2.96e-04 5.44e-01 0.00e+00
 119 -3.7915191359591787e+04 9.08e-04 5.40e-01 0.00e+00
 120 -3.7914789947524907e+04 1.44e-03 5.36e-01 0.00e+00
 121 -3.7915792818974951e+04 8.28e-05 5.32e-01 0.00e+00
 122 -3.7916823748185045e+04 5.39e-05 5.28e-01 0.00e+00
 123 -3.7917849034229737e+04 7.51e-05 5.24e-01 0.00e+00
 124 -3.7918865919504438e+04 1.09e-04 5.20e-01 0.00e+00
 125 -3.7919862768419160e+04 1.76e-04 5.16e-01 0.00e+00
 126 -3.7920773252345985e+04 3.22e-04 5.12e-01 0.00e+00
 127 -3.7921309477998104e+04 6.56e-04 5.08e-01 0.00e+00
 128 -3.7921484106151322e+04 1.02e-03 5.05e-01 0.00e+00
 129 -3.7922432913697630e+04 4.75e-04 5.01e-01 0.00e+00
 130 -3.7923594553802861e+04 2.38e-04 4.97e-01 0.00e+00
 131 -3.7919004716625677e+04 1.53e-03 4.93e-01 0.00e+00
 132 -3.7916876155878897e+04 1.27e-03 4.89e-01 0.00e+00
 133 -3.7917959858174858e+04 5.43e-05 4.86e-01 0.00e+00
 134 -3.7918895894331035e+04 3.66e-05 4.82e-01 0.00e+00
 135 -3.7919745975859405e+04 2.56e-05 4.78e-01 0.00e+00
 136 -3.7920543360815049e+04 1.80e-05 4.74e-01 0.00e+00
 137 -3.7921306487863541e+04 1.27e-05 4.71e-01 0.00e+00
 138 -3.7922045690675848e+04 9.05e-06 4.67e-01 0.00e+00
 139 -3.7922766674231338e+04 6.45e-06 4.64e-01 0.00e+00
 140 -3.7923472876291737e+04 4.62e-06 4.60e-01 0.00e+00
 141 -3.7924166167769210e+04 3.31e-06 4.56e-01 0.00e+00
 142 -3.7924847606779978e+04 2.48e-06 4.53e-01 0.00e+00
 143 -3.7925517982078549e+04 2.59e-06 4.49e-01 0.00e+00
 144 -3.7926177607588885e+04 2.67e-06 4.46e-01 0.00e+00
 145 -3.7926826851697173e+04 2.74e-06 4.42e-01 0.00e+00
 146 -3.7927466001688255e+04 2.79e-06 4.39e-01 0.00e+00
 147 -3.7928095230872779e+04 2.83e-06 4.35e-01 0.00e+00
 148 -3.7928714780008173e+04 2.88e-06 4.32e-01 0.00e+00
 149 -3.7929324738073643e+04 2.92e-06 4.29e-01 0.00e+00
 150 -3.7929925385273753e+04 2.97e-06 4.25e-01 0.00e+00
 151 -3.7930516854642279e+04 3.01e-06 4.22e-01 0.00e+00
 152 -3.7931099298534544e+04 3.07e-06 4.19e-01 0.00e+00
 153 -3.7931672981370197e+04 3.12e-06 4.15e-01 0.00e+00
 154 -3.7932237998225908e+04 3.18e-06 4.12e-01 0.00e+00
 155 -3.7932794537150578e+04 3.25e-06 4.09e-01 0.00e+00
 156 -3.7933342793095704e+04 3.32e-06 4.05e-01 0.00e+00
 157 -3.7933882948115810e+04 3.40e-06 4.02e-01 0.00e+00
 158 -3.7934415169631007e+04 3.49e-06 3.99e-01 0.00e+00
 159 -3.7934939570907460e+04 3.58e-06 3.96e-01 0.00e+00
 160 -3.7935456322246791e+04 3.69e-06 3.93e-01 0.00e+00
 161 -3.7935965745595269e+04 3.80e-06 3.90e-01 0.00e+00
 162 -3.7936468021096749e+04 3.93e-06 3.86e-01 0.00e+00
 163 -3.7936962887589390e+04 4.08e-06 3.83e-01 0.00e+00
 164 -3.7937450877537682e+04 4.24e-06 3.80e-01 0.00e+00
 165 -3.7937932104517873e+04 4.43e-06 3.77e-01 0.00e+00
 166 -3.7938406916298256e+04 4.64e-06 3.74e-01 0.00e+00
 167 -3.7938875195727211e+04 4.87e-06 3.71e-01 0.00e+00
 168 -3.7939337249501092e+04 5.14e-06 3.68e-01 0.00e+00
 169 -3.7939793261434141e+04 5.45e-06 3.65e-01 0.00e+00
 170 -3.7940243432331568e+04 5.82e-06 3.62e-01 0.00e+00
 171 -3.7940688009484242e+04 6.25e-06 3.59e-01 0.00e+00
 172 -3.7941127289729578e+04 6.76e-06 3.56e-01 0.00e+00
 173 -3.7941561546512123e+04 7.37e-06 3.54e-01 0.00e+00
 174 -3.7941991104034954e+04 8.13e-06 3.51e-01 0.00e+00
 175 -3.7942416510021139e+04 9.09e-06 3.48e-01 0.00e+00
 176 -3.7942838273789872e+04 1.03e-05 3.45e-01 0.00e+00
 177 -3.7943257171507248e+04 1.19e-05 3.42e-01 0.00e+00
 178 -3.7943674430665887e+04 1.42e-05 3.39e-01 0.00e+00
 179 -3.7944091773508640e+04 1.74e-05 3.37e-01 0.00e+00
 180 -3.7944512077495339e+04 2.24e-05 3.34e-01 0.00e+00
 181 -3.7944940759071396e+04 3.06e-05 3.31e-01 0.00e+00
 182 -3.7945388565692090e+04 4.58e-05 3.28e-01 0.00e+00
 183 -3.7945879261299640e+04 7.93e-05 3.26e-01 0.00e+00
 184 -3.7946445574764919e+04 1.76e-04 3.23e-01 0.00e+00
 185 -3.7945507383360913e+04 6.42e-04 3.21e-01 0.00e+00
 186 -3.7929245136019206e+04 3.67e-03 5.07e-01 0.00e+00
 187 -3.7923742709258368e+04 1.77e-03 4.03e-01 0.00e+00
 188 -3.7924499470328527e+04 7.93e-06 3.13e-01 0.00e+00
 189 -3.7925075527603534e+04 1.49e-05 3.10e-01 0.00e+00
 190 -3.7925545358462536e+04 1.09e-05 3.08e-01 0.00e+00
 191 -3.7925953199654272e+04 7.16e-06 3.05e-01 0.00e+00
 192 -3.7926324208861632e+04 4.61e-06 3.02e-01 0.00e+00
 193 -3.7926669930683187e+04 2.98e-06 3.00e-01 0.00e+00
 194 -3.7927004546577009e+04 1.95e-06 2.98e-01 0.00e+00
 195 -3.7927328961722575e+04 1.30e-06 2.95e-01 0.00e+00
 196 -3.7927645867108520e+04 8.74e-07 2.93e-01 0.00e+00
 197 -3.7927957079451895e+04 5.96e-07 2.90e-01 0.00e+00
 198 -3.7928263383761303e+04 5.11e-07 2.88e-01 0.00e+00
 199 -3.7928565348754775e+04 4.81e-07 2.85e-01 0.00e+00
 200 -3.7928863354439200e+04 4.57e-07 2.83e-01 0.00e+00
 201 -3.7929157523014008e+04 4.37e-07 2.81e-01 0.00e+00
 202 -3.7929448048557351e+04 4.18e-07 2.78e-01 0.00e+00
 203 -3.7929734939713941e+04 4.01e-07 2.76e-01 0.00e+00
 204 -3.7930018332265812e+04 3.85e-07 2.74e-01 0.00e+00
 205 -3.7930298274300178e+04 3.70e-07 2.71e-01 0.00e+00
 206 -3.7930574788606871e+04 3.55e-07 2.69e-01 0.00e+00
 207 -3.7930847957783903e+04 3.41e-07 2.67e-01 0.00e+00
 208 -3.7931117846464127e+04 3.28e-07 2.65e-01 0.00e+00
 209 -3.7931384454654697e+04 3.15e-07 2.62e-01 0.00e+00
 210 -3.7931647822812767e+04 3.03e-07 2.60e-01 0.00e+00
 211 -3.7931908030634353e+04 2.91e-07 2.58e-01 0.00e+00
 212 -3.7932165085626948e+04 2.79e-07 2.56e-01 0.00e+00
 213 -3.7932419051207755e+04 2.68e-07 2.54e-01 0.00e+00
 214 -3.7932669960083156e+04 2.58e-07 2.52e-01 0.00e+00
 215 -3.7932917868787255e+04 2.48e-07 2.49e-01 0.00e+00
 216 -3.7933162792404153e+04 2.38e-07 2.47e-01 0.00e+00
 217 -3.7933404783518105e+04 2.28e-07 2.45e-01 0.00e+00
 218 -3.7933643886884580e+04 2.19e-07 2.43e-01 0.00e+00
 219 -3.7933880169015843e+04 2.10e-07 2.41e-01 0.00e+00
 220 -3.7934113593722926e+04 2.02e-07 2.39e-01 0.00e+00
 221 -3.7934344220641222e+04 1.94e-07 2.37e-01 0.00e+00
 222 -3.7934572126871150e+04 1.86e-07 2.35e-01 0.00e+00
 223 -3.7934797332240072e+04 1.78e-07 2.33e-01 0.00e+00
 224 -3.7935019891291515e+04 1.71e-07 2.31e-01 0.00e+00
 225 -3.7935239790955704e+04 1.64e-07 2.29e-01 0.00e+00
 226 -3.7935457089833937e+04 1.61e-07 2.27e-01 0.00e+00
 227 -3.7935671830389547e+04 1.61e-07 2.25e-01 0.00e+00
 228 -3.7935884037339150e+04 1.60e-07 2.23e-01 0.00e+00
 229 -3.7936093740909833e+04 1.60e-07 2.21e-01 0.00e+00
 230 -3.7936300989549643e+04 1.59e-07 2.20e-01 0.00e+00
 231 -3.7936505794130266e+04 1.58e-07 2.18e-01 0.00e+00
 232 -3.7936708186058015e+04 1.58e-07 2.16e-01 0.00e+00
 233 -3.7936908212856906e+04 1.57e-07 2.14e-01 0.00e+00
 234 -3.7937105977657171e+04 1.56e-07 2.12e-01 0.00e+00
 235 -3.7937301375262308e+04 1.55e-07 2.10e-01 0.00e+00
 236 -3.7937494492376325e+04 1.55e-07 2.09e-01 0.00e+00
 237 -3.7937685388269718e+04 1.54e-07 2.07e-01 0.00e+00
 238 -3.7937874037576905e+04 1.53e-07 2.05e-01 0.00e+00
 239 -3.7938060508345232e+04 1.52e-07 2.03e-01 0.00e+00
 240 -3.7938244807055133e+04 1.51e-07 2.02e-01 0.00e+00
 241 -3.7938426987491577e+04 1.50e-07 2.00e-01 0.00e+00
 242 -3.7938607032778345e+04 1.50e-07 1.98e-01 0.00e+00
 243 -3.7938785028593717e+04 1.49e-07 1.96e-01 0.00e+00
 244 -3.7938960956954827e+04 1.48e-07 1.95e-01 0.00e+00
 245 -3.7939134835495475e+04 1.47e-07 1.93e-01 0.00e+00
 246 -3.7939306746730173e+04 1.46e-07 1.91e-01 0.00e+00
 247 -3.7939476664127003e+04 1.45e-07 1.90e-01 0.00e+00
 248 -3.7939644652761956e+04 1.44e-07 1.88e-01 0.00e+00
 249 -3.7939810719785295e+04 1.43e-07 1.86e-01 0.00e+00
 250 -3.7939974878051617e+04 1.42e-07 1.85e-01 0.00e+00
 251 -3.7940137162534025e+04 1.41e-07 1.83e-01 0.00e+00
 252 -3.7940297592150579e+04 1.40e-07 1.82e-01 0.00e+00
 253 -3.7940456198354077e+04 1.39e-07 1.80e-01 0.00e+00
 254 -3.7940612990595822e+04 1.38e-07 1.79e-01 0.00e+00
 255 -3.7940767996808390e+04 1.37e-07 1.77e-01 0.00e+00
 256 -3.7940921249672989e+04 1.35e-07 1.76e-01 0.00e+00
 257 -3.7941072764934223e+04 1.34e-07 1.74e-01 0.00e+00
 258 -3.7941222560846356e+04 1.33e-07 1.73e-01 0.00e+00
 259 -3.7941370660952911e+04 1.32e-07 1.71e-01 0.00e+00
 260 -3.7941517091744419e+04 1.31e-07 1.70e-01 0.00e+00
 261 -3.7941661869952521e+04 1.30e-07 1.68e-01 0.00e+00
 262 -3.7941805026722999e+04 1.29e-07 1.67e-01 0.00e+00
 263 -3.7941946550895569e+04 1.28e-07 1.65e-01 0.00e+00
 264 -3.7942084070594909e+04 1.27e-07 1.64e-01 0.00e+00
 265 -3.7942224029886107e+04 1.26e-07 1.62e-01 0.00e+00
 266 -3.7942360848342898e+04 1.24e-07 1.61e-01 0.00e+00
 267 -3.7942496143707060e+04 1.23e-07 1.60e-01 0.00e+00
 268 -3.7942629928216331e+04 1.22e-07 1.58e-01 0.00e+00
 269 -3.7942762217379277e+04 1.21e-07 1.57e-01 0.00e+00
 270 -3.7942893037901747e+04 1.20e-07 1.55e-01 0.00e+00
 271 -3.7943022400602531e+04 1.19e-07 1.54e-01 0.00e+00
 272 -3.7943150313255595e+04 1.18e-07 1.53e-01 0.00e+00
 273 -3.7943276808505114e+04 1.17e-07 1.51e-01 0.00e+00
 274 -3.7943401883065344e+04 1.15e-07 1.50e-01 0.00e+00
 275 -3.7943525582645707e+04 1.14e-07 1.49e-01 0.00e+00
 276 -3.7943648051042335e+04 1.13e-07 1.47e-01 0.00e+00
 277 -3.7943769025268768e+04 1.12e-07 1.46e-01 0.00e+00
 278 -3.7943888640826466e+04 1.11e-07 1.45e-01 0.00e+00
 279 -3.7944006917173741e+04 1.10e-07 1.44e-01 0.00e+00
 280 -3.7944123868694034e+04 1.09e-07 1.42e-01 0.00e+00
 281 -3.7944239498475137e+04 1.08e-07 1.41e-01 0.00e+00
 282 -3.7944354034019496e+04 1.07e-07 1.40e-01 0.00e+00
 283 -3.7944467235120050e+04 1.05e-07 1.39e-01 0.00e+00
 284 -3.7944579194356855e+04 1.04e-07 1.37e-01 0.00e+00
 285 -3.7944689907153224e+04 1.03e-07 1.36e-01 0.00e+00
 286 -3.7944799415285837e+04 1.02e-07 1.35e-01 0.00e+00
 287 -3.7944907725775753e+04 1.01e-07 1.34e-01 0.00e+00
 288 -3.7945014857246162e+04 9.99e-08 1.33e-01 0.00e+00
 289 -3.7945120812850386e+04 9.88e-08 1.32e-01 0.00e+00
 290 -3.7945225613695111e+04 9.77e-08 1.30e-01 0.00e+00
 291 -3.7945329272849325e+04 9.67e-08 1.29e-01 0.00e+00
 292 -3.7945431774096323e+04 9.56e-08 1.28e-01 0.00e+00
 293 -3.7945533188433059e+04 9.45e-08 1.27e-01 0.00e+00
 294 -3.7945633502470999e+04 9.35e-08 1.26e-01 0.00e+00
 295 -3.7945732702341338e+04 9.24e-08 1.25e-01 0.00e+00
 296 -3.7945830845210650e+04 9.14e-08 1.24e-01 0.00e+00
 297 -3.7945927919075351e+04 9.03e-08 1.23e-01 0.00e+00
 298 -3.7946023944461216e+04 8.93e-08 1.22e-01 0.00e+00
 299 -3.7946118937044957e+04 8.83e-08 1.20e-01 0.00e+00
 300 -3.7946212901902116e+04 8.73e-08 1.19e-01 0.00e+00
 301 -3.7946305863633082e+04 8.62e-08 1.18e-01 0.00e+00
 302 -3.7946397816269055e+04 8.52e-08 1.17e-01 0.00e+00
 303 -3.7946488761930334e+04 8.42e-08 1.16e-01 0.00e+00
 304 -3.7946578752401023e+04 8.32e-08 1.15e-01 0.00e+00
 305 -3.7946667775270427e+04 8.22e-08 1.14e-01 0.00e+00
 306 -3.7946755837619588e+04 8.13e-08 1.13e-01 0.00e+00
 307 -3.7946842982856127e+04 8.01e-08 1.12e-01 0.00e+00
 308 -3.7946929169392730e+04 7.95e-08 1.11e-01 0.00e+00
 309 -3.7947014439760918e+04 7.84e-08 1.10e-01 0.00e+00
 310 -3.7947098801700580e+04 7.74e-08 1.09e-01 0.00e+00
 311 -3.7947182261426104e+04 7.65e-08 1.08e-01 0.00e+00
 312 -3.7947264833042165e+04 7.55e-08 1.07e-01 0.00e+00
 313 -3.7947346526456320e+04 7.46e-08 1.06e-01 0.00e+00
 314 -3.7947427347257522e+04 7.37e-08 1.05e-01 0.00e+00
 315 -3.7947507311017260e+04 7.28e-08 1.05e-01 0.00e+00
 316 -3.7947586425956171e+04 7.19e-08 1.04e-01 0.00e+00
 317 -3.7947664701895017e+04 7.10e-08 1.03e-01 0.00e+00
 318 -3.7947742148554884e+04 7.01e-08 1.02e-01 0.00e+00
 319 -3.7947818775523381e+04 6.92e-08 1.01e-01 0.00e+00
 320 -3.7947894592263467e+04 6.84e-08 1.00e-01 0.00e+00
 321 -3.7947969608114989e+04 6.75e-08 9.91e-02 0.00e+00
 322 -3.7948043832295931e+04 6.66e-08 9.83e-02 0.00e+00
 323 -3.7948117273903626e+04 6.58e-08 9.74e-02 0.00e+00
 324 -3.7948189941915756e+04 6.50e-08 9.65e-02 0.00e+00
 325 -3.7948261845191235e+04 6.41e-08 9.57e-02 0.00e+00
 326 -3.7948332992470911e+04 6.33e-08 9.48e-02 0.00e+00
 327 -3.7948403392378226e+04 6.25e-08 9.40e-02 0.00e+00
 328 -3.7948473057886222e+04 6.17e-08 9.31e-02 0.00e+00
 329 -3.7948541984601288e+04 6.09e-08 9.23e-02 0.00e+00
 330 -3.7948610181295153e+04 6.01e-08 9.15e-02 0.00e+00
 331 -3.7948677674539256e+04 5.92e-08 9.07e-02 0.00e+00</code></pre>
</div>
<div id="run-flashier-using-mashvflash" class="section level2">
<h2>Run flashier using MASHvFLASH</h2>
<pre class="r"><code>mash_data &lt;- mashr::mash_set_data(Bhat = X, Shat = 1)
fl &lt;- mishmashr::mashy_flash(
  mash_data,
  greedy.Kmax = 5, 
  backfit = TRUE,
  verbose = 0
)</code></pre>
<pre class="r"><code>U.fl = list()
for (i in 1:ncol(fl$F.pm)){
  U.fl[[i]] = fl$F.pm[,i] %*% t(fl$F.pm[,i])
}</code></pre>
</div>
<div id="plot-sharing-patterns" class="section level2">
<h2>Plot sharing patterns</h2>
<pre class="r"><code>plot_sharing = function(X, to_cor=FALSE, title=&quot;&quot;, remove_names=F) {
        clrs &lt;- colorRampPalette(rev(c(&quot;#D73027&quot;,&quot;#FC8D59&quot;,&quot;#FEE090&quot;,&quot;#FFFFBF&quot;,
                                       &quot;#E0F3F8&quot;,&quot;#91BFDB&quot;,&quot;#4575B4&quot;)))(128)
        if (to_cor) lat &lt;- cov2cor(X)
        else lat = X/max(diag(X))
        lat[lower.tri(lat)] &lt;- NA
        n &lt;- nrow(lat)
        if (remove_names) {
          colnames(lat) = NULL
          rownames(lat) = NULL
        }
        return(lattice::levelplot(lat[n:1,],col.regions = clrs,
                                xlab = &quot;&quot;,ylab = &quot;&quot;, main=title,
                                colorkey = TRUE,at = seq(-1,1,length.out = 128),
                                scales = list(cex = 0.2,x = list(rot = 45))))
    }</code></pre>
<pre class="r"><code># Plot sharing patterns with w &gt; 0.01 
tol = 1e-2
U &lt;- lapply(fit1$U,function (e) &quot;[[&quot;(e,&quot;mat&quot;))
n_component = sum(fit1$w &gt; tol)
w = order(fit1$w, decreasing = TRUE)
indx = w[1:n_component]</code></pre>
<pre class="r"><code>plts = list()
for (i in 1:length(indx)){
  title = paste(names(U)[indx[i]], &quot;w =&quot;, round(fit1$w[indx[i]], 6))
  plts[[i]] = plot_sharing(U[[indx[i]]], to_cor = TRUE)
}</code></pre>
<pre class="r"><code>unit = 4
n_col = 3
n_row = ceiling(n_component / n_col)
pdf(&#39;t2d_patterns.pdf&#39;, width = unit * n_col, height = unit * n_row)
do.call(&quot;grid.arrange&quot;, c(plts, list(ncol = n_col, nrow = n_row)))
dev.off()</code></pre>
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
<div id="flashier-patterns" class="section level2">
<h2>flashier patterns</h2>
<pre class="r"><code>plts = list()
for (i in 1:length(U.fl)){
  plts[[i]] = plot_sharing(U.fl[[i]], to_cor = TRUE, title = title)
}</code></pre>
<pre class="r"><code>unit = 4
n_col = 3
n_row = ceiling(n_component / n_col)
pdf(&#39;t2d_patterns_flashier.pdf&#39;, width = unit * n_col, height = unit * n_row)
do.call(&quot;grid.arrange&quot;, c(plts, list(ncol = n_col, nrow = n_row)))
dev.off()</code></pre>
<pre><code>quartz_off_screen 
                2 </code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.1.1 (2021-08-10)
Platform: x86_64-apple-darwin20.6.0 (64-bit)
Running under: macOS Monterey 12.0.1

Matrix products: default
BLAS:   /usr/local/Cellar/openblas/0.3.18/lib/libopenblasp-r0.3.18.dylib
LAPACK: /usr/local/Cellar/r/4.1.1_1/lib/R/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] mishmashr_0.1.1 gridExtra_2.3   udr_0.3-141     readxl_1.4.1   
[5] workflowr_1.6.2

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.8.3      horseshoe_0.2.0   invgamma_1.1      mvtnorm_1.1-3    
 [5] lattice_0.20-44   assertthat_0.2.1  rprojroot_2.0.2   digest_0.6.28    
 [9] utf8_1.2.2        truncnorm_1.0-8   R6_2.5.1          cellranger_1.1.0 
[13] plyr_1.8.6        evaluate_0.14     ggplot2_3.3.5     pillar_1.6.4     
[17] rlang_0.4.12      ebnm_0.1-59       irlba_2.3.5       whisker_0.4      
[21] jquerylib_0.1.4   Matrix_1.3-4      rmarkdown_2.11    mashr_0.2.51     
[25] splines_4.1.1     stringr_1.4.0     REBayes_2.50      munsell_0.5.0    
[29] mixsqp_0.3-43     compiler_4.1.1    httpuv_1.6.3      xfun_0.27        
[33] pkgconfig_2.0.3   SQUAREM_2021.1    htmltools_0.5.2   tidyselect_1.1.1 
[37] tibble_3.1.5      fansi_0.5.0       crayon_1.4.1      dplyr_1.0.7      
[41] later_1.3.0       grid_4.1.1        gtable_0.3.0      lifecycle_1.0.1  
[45] git2r_0.28.0      magrittr_2.0.1    scales_1.1.1      stringi_1.7.5    
[49] fs_1.5.0          promises_1.2.0.1  flashier_0.2.32   ellipsis_0.3.2   
[53] vctrs_0.3.8       generics_0.1.2    trust_0.1-8       rmeta_3.0        
[57] tools_4.1.1       glue_1.4.2        softImpute_1.4-1  purrr_0.3.4      
[61] parallel_4.1.1    abind_1.4-5       fastmap_1.1.0     yaml_2.2.1       
[65] colorspace_2.0-2  ashr_2.2-47       deconvolveR_1.2-1 knitr_1.36       </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
